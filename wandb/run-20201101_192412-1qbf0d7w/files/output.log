RegressionModel(
  (embs): ModuleList(
    (0): Embedding(13, 6)
    (1): Embedding(5, 2)
    (2): Embedding(9, 4)
    (3): Embedding(4, 2)
    (4): Embedding(4, 2)
    (5): Embedding(4, 2)
    (6): Embedding(3, 1)
    (7): Embedding(11, 5)
    (8): Embedding(6, 3)
    (9): Embedding(4, 2)
  )
  (lins): ModuleList(
    (0): Linear(in_features=39, out_features=1000, bias=True)
    (1): Linear(in_features=1000, out_features=500, bias=True)
    (2): Linear(in_features=500, out_features=250, bias=True)
  )
  (bns): ModuleList(
    (0): GroupNorm(1, 1000, eps=1e-05, affine=True)
    (1): GroupNorm(1, 500, eps=1e-05, affine=True)
    (2): GroupNorm(1, 250, eps=1e-05, affine=True)
  )
  (outp): Linear(in_features=250, out_features=1, bias=True)
  (emb_drop): Dropout(p=0.04, inplace=False)
  (drops): ModuleList(
    (0): Dropout(p=0.001, inplace=False)
    (1): Dropout(p=0.01, inplace=False)
    (2): Dropout(p=0.01, inplace=False)
  )
  (bn): GroupNorm(1, 10, eps=1e-05, affine=True)
  (activation): Sigmoid()
) 


=== RUN # 0 ====================================

  0%|          | 0/572 [00:00<?, ?it/s]  1%|          | 3/572 [00:00<00:19, 28.60it/s]  2%|▏         | 12/572 [00:00<00:15, 35.57it/s]  4%|▎         | 21/572 [00:00<00:12, 43.04it/s]  5%|▌         | 30/572 [00:00<00:10, 50.50it/s]  7%|▋         | 39/572 [00:00<00:09, 57.43it/s]  8%|▊         | 48/572 [00:00<00:08, 63.21it/s] 10%|▉         | 57/572 [00:00<00:07, 68.45it/s] 12%|█▏        | 66/572 [00:00<00:07, 72.27it/s] 13%|█▎        | 74/572 [00:00<00:06, 74.18it/s] 14%|█▍        | 82/572 [00:01<00:06, 75.82it/s] 16%|█▌        | 90/572 [00:01<00:06, 75.73it/s] 17%|█▋        | 99/572 [00:01<00:06, 77.26it/s] 19%|█▊        | 107/572 [00:01<00:06, 77.18it/s] 20%|██        | 115/572 [00:01<00:05, 77.35it/s] 22%|██▏       | 124/572 [00:01<00:05, 78.59it/s] 23%|██▎       | 133/572 [00:01<00:05, 79.66it/s] 25%|██▍       | 142/572 [00:01<00:05, 75.56it/s] 26%|██▋       | 151/572 [00:01<00:05, 77.59it/s] 28%|██▊       | 160/572 [00:02<00:05, 78.70it/s] 29%|██▉       | 168/572 [00:02<00:05, 77.52it/s] 31%|███       | 176/572 [00:02<00:05, 78.18it/s] 32%|███▏      | 185/572 [00:02<00:04, 79.36it/s] 34%|███▎      | 193/572 [00:02<00:05, 74.56it/s] 35%|███▌      | 201/572 [00:02<00:04, 75.91it/s] 37%|███▋      | 210/572 [00:02<00:04, 77.78it/s] 38%|███▊      | 218/572 [00:02<00:05, 60.52it/s] 39%|███▉      | 225/572 [00:03<00:05, 62.24it/s] 41%|████      | 233/572 [00:03<00:05, 65.68it/s] 42%|████▏     | 241/572 [00:03<00:04, 69.36it/s] 44%|████▎     | 249/572 [00:03<00:04, 71.05it/s] 45%|████▌     | 258/572 [00:03<00:04, 74.80it/s] 47%|████▋     | 267/572 [00:03<00:03, 77.32it/s] 48%|████▊     | 276/572 [00:03<00:03, 78.67it/s] 50%|████▉     | 285/572 [00:03<00:03, 79.98it/s] 51%|█████▏    | 294/572 [00:03<00:03, 81.27it/s] 53%|█████▎    | 303/572 [00:03<00:03, 82.52it/s] 55%|█████▍    | 312/572 [00:04<00:03, 82.14it/s] 56%|█████▌    | 321/572 [00:04<00:03, 81.20it/s] 58%|█████▊    | 330/572 [00:04<00:02, 81.32it/s] 59%|█████▉    | 339/572 [00:04<00:02, 81.52it/s] 61%|██████    | 348/572 [00:04<00:02, 77.67it/s] 62%|██████▏   | 356/572 [00:04<00:02, 74.67it/s] 64%|██████▎   | 364/572 [00:04<00:02, 74.61it/s] 65%|██████▌   | 373/572 [00:04<00:02, 76.92it/s] 67%|██████▋   | 382/572 [00:04<00:02, 79.22it/s] 68%|██████▊   | 390/572 [00:05<00:02, 75.30it/s] 70%|██████▉   | 398/572 [00:05<00:02, 72.12it/s] 71%|███████   | 406/572 [00:05<00:02, 73.67it/s] 73%|███████▎  | 415/572 [00:05<00:02, 77.02it/s] 74%|███████▍  | 424/572 [00:05<00:01, 77.46it/s] 76%|███████▌  | 432/572 [00:05<00:01, 74.38it/s] 77%|███████▋  | 440/572 [00:05<00:01, 71.65it/s] 78%|███████▊  | 448/572 [00:05<00:01, 72.13it/s] 80%|███████▉  | 456/572 [00:05<00:01, 71.73it/s] 81%|████████  | 464/572 [00:06<00:01, 70.91it/s] 83%|████████▎ | 472/572 [00:06<00:01, 68.78it/s] 84%|████████▍ | 480/572 [00:06<00:01, 70.80it/s] 85%|████████▌ | 489/572 [00:06<00:01, 74.04it/s] 87%|████████▋ | 498/572 [00:06<00:00, 76.71it/s] 89%|████████▊ | 507/572 [00:06<00:00, 78.33it/s] 90%|█████████ | 516/572 [00:06<00:00, 80.05it/s] 92%|█████████▏| 525/572 [00:06<00:00, 80.99it/s] 93%|█████████▎| 534/572 [00:07<00:00, 79.62it/s] 95%|█████████▍| 542/572 [00:07<00:00, 76.89it/s] 96%|█████████▋| 551/572 [00:07<00:00, 78.04it/s] 98%|█████████▊| 560/572 [00:07<00:00, 79.36it/s] 99%|█████████▉| 569/572 [00:07<00:00, 80.81it/s]100%|██████████| 572/572 [00:07<00:00, 76.50it/s]Train Epoch: 1 	 Loss: 0.4743998842
  0%|          | 0/1 [00:00<?, ?it/s]
/Users/eunbeejang/miniconda3/envs/py38/lib/python3.8/site-packages/sklearn/utils/validation.py:67: FutureWarning: Pass labels=[1, 0] as keyword args. From version 0.25 passing these as positional arguments will result in an error
  warnings.warn("Pass {} as keyword args. From version 0.25 "
100%|██████████| 1/1 [00:00<00:00,  3.66it/s]100%|██████████| 1/1 [00:00<00:00,  3.65it/s]
[[ 314  137]
 [ 309 3359]]

Test set: Average loss: 0.0001, Accuracy: 89.17%


Test set: Average fairness score:
Overall recall: 0.6962, 
Recall by Group: {0: 0.6511627906976745, 1: 0.7182539682539683, 2: 0.6709677419354839, 3: 1.0}, 
Equalized Odds: 0.3488, 
Demographic Parity: 0.2381 

{'accuracy': 89.17212915756251, 'avg_loss': 5.475282813773974e-05, 'recall': 0.6962305986696231, 'avg_eq_odds': 0.34883720930232553, 'avg_dem_par': 0.23807582551977172, 'basic.4y': 0.6511627906976745, 'basic.6y': 0.7182539682539683, 'basic.9y': 0.6709677419354839, 'high.school': 1.0}
wandb: WARNING Calling wandb.login() after wandb.init() has no effect.

=== RUN # 1 ====================================

  0%|          | 0/572 [00:00<?, ?it/s]  1%|▏         | 8/572 [00:00<00:07, 73.67it/s]  3%|▎         | 16/572 [00:00<00:07, 74.18it/s]  4%|▍         | 23/572 [00:00<00:07, 71.78it/s]  5%|▌         | 30/572 [00:00<00:07, 71.17it/s]  7%|▋         | 39/572 [00:00<00:07, 74.40it/s]  8%|▊         | 48/572 [00:00<00:06, 76.37it/s] 10%|▉         | 57/572 [00:00<00:06, 77.75it/s] 12%|█▏        | 66/572 [00:00<00:06, 79.05it/s] 13%|█▎        | 75/572 [00:00<00:06, 79.89it/s] 15%|█▍        | 84/572 [00:01<00:06, 80.17it/s] 16%|█▋        | 93/572 [00:01<00:05, 80.70it/s] 18%|█▊        | 102/572 [00:01<00:05, 81.44it/s] 19%|█▉        | 111/572 [00:01<00:06, 76.58it/s] 21%|██        | 120/572 [00:01<00:05, 78.41it/s] 23%|██▎       | 129/572 [00:01<00:05, 79.10it/s] 24%|██▍       | 138/572 [00:01<00:05, 80.02it/s] 26%|██▌       | 147/572 [00:01<00:05, 80.07it/s] 27%|██▋       | 156/572 [00:01<00:05, 81.04it/s] 29%|██▉       | 165/572 [00:02<00:04, 81.41it/s] 30%|███       | 174/572 [00:02<00:04, 81.20it/s] 32%|███▏      | 183/572 [00:02<00:04, 81.76it/s] 34%|███▎      | 192/572 [00:02<00:04, 82.06it/s] 35%|███▌      | 201/572 [00:02<00:04, 82.42it/s] 37%|███▋      | 210/572 [00:02<00:04, 82.69it/s] 38%|███▊      | 219/572 [00:02<00:04, 82.50it/s] 40%|███▉      | 228/572 [00:02<00:04, 82.58it/s] 41%|████▏     | 237/572 [00:02<00:04, 82.75it/s] 43%|████▎     | 246/572 [00:03<00:03, 83.16it/s] 45%|████▍     | 255/572 [00:03<00:03, 83.27it/s] 46%|████▌     | 264/572 [00:03<00:03, 83.35it/s] 48%|████▊     | 273/572 [00:03<00:03, 82.69it/s] 49%|████▉     | 282/572 [00:03<00:03, 82.40it/s] 51%|█████     | 291/572 [00:03<00:03, 82.23it/s] 52%|█████▏    | 300/572 [00:03<00:03, 82.41it/s] 54%|█████▍    | 309/572 [00:03<00:03, 82.78it/s] 56%|█████▌    | 318/572 [00:03<00:03, 82.54it/s] 57%|█████▋    | 327/572 [00:04<00:02, 81.85it/s] 59%|█████▊    | 336/572 [00:04<00:02, 82.44it/s] 60%|██████    | 345/572 [00:04<00:02, 82.31it/s] 62%|██████▏   | 354/572 [00:04<00:02, 82.25it/s] 63%|██████▎   | 363/572 [00:04<00:02, 81.55it/s] 65%|██████▌   | 372/572 [00:04<00:02, 81.22it/s] 67%|██████▋   | 381/572 [00:04<00:02, 81.64it/s] 68%|██████▊   | 390/572 [00:04<00:02, 80.96it/s] 70%|██████▉   | 399/572 [00:04<00:02, 80.77it/s] 71%|███████▏  | 408/572 [00:05<00:02, 80.77it/s] 73%|███████▎  | 417/572 [00:05<00:01, 80.20it/s] 74%|███████▍  | 426/572 [00:05<00:01, 81.08it/s] 76%|███████▌  | 435/572 [00:05<00:01, 81.27it/s] 78%|███████▊  | 444/572 [00:05<00:01, 81.07it/s] 79%|███████▉  | 453/572 [00:05<00:01, 81.18it/s] 81%|████████  | 462/572 [00:05<00:01, 81.35it/s] 82%|████████▏ | 471/572 [00:05<00:01, 76.86it/s] 84%|████████▎ | 479/572 [00:05<00:01, 73.36it/s] 85%|████████▌ | 487/572 [00:06<00:01, 74.66it/s] 87%|████████▋ | 496/572 [00:06<00:00, 77.16it/s] 88%|████████▊ | 504/572 [00:06<00:00, 77.91it/s] 90%|████████▉ | 513/572 [00:06<00:00, 78.40it/s] 91%|█████████ | 521/572 [00:06<00:00, 74.32it/s] 92%|█████████▏| 529/572 [00:06<00:00, 73.77it/s] 94%|█████████▍| 537/572 [00:06<00:00, 75.16it/s] 95%|█████████▌| 546/572 [00:06<00:00, 77.04it/s] 97%|█████████▋| 555/572 [00:06<00:00, 78.78it/s] 99%|█████████▊| 564/572 [00:07<00:00, 79.95it/s]100%|██████████| 572/572 [00:07<00:00, 80.10it/s]Train Epoch: 1 	 Loss: 0.4482146461
  0%|          | 0/1 [00:00<?, ?it/s]
[[ 357   94]
 [ 396 3272]]100%|██████████| 1/1 [00:00<00:00,  2.94it/s]100%|██████████| 1/1 [00:00<00:00,  2.94it/s]


Test set: Average loss: 0.0001, Accuracy: 88.10%


Test set: Average fairness score:
Overall recall: 0.7916, 
Recall by Group: {0: 0.7441860465116279, 1: 0.8134920634920635, 2: 0.7677419354838709, 3: 1.0}, 
Equalized Odds: 0.3355, 
Demographic Parity: 0.3245 

{'accuracy': 88.10390871570769, 'avg_loss': 6.318386100570852e-05, 'recall': 0.7915742793791575, 'avg_eq_odds': 0.33548387096774196, 'avg_dem_par': 0.3245006114961272, 'basic.4y': 0.7441860465116279, 'basic.6y': 0.8134920634920635, 'basic.9y': 0.7677419354838709, 'high.school': 1.0}
wandb: WARNING Calling wandb.login() after wandb.init() has no effect.

=== RUN # 2 ====================================
  0%|          | 0/572 [00:00<?, ?it/s]
  1%|▏         | 8/572 [00:00<00:07, 73.28it/s]  3%|▎         | 17/572 [00:00<00:07, 76.00it/s]  5%|▍         | 26/572 [00:00<00:07, 77.62it/s]  6%|▌         | 35/572 [00:00<00:06, 79.33it/s]  8%|▊         | 44/572 [00:00<00:06, 80.34it/s]  9%|▉         | 53/572 [00:00<00:06, 81.30it/s] 11%|█         | 62/572 [00:00<00:06, 82.20it/s] 12%|█▏        | 71/572 [00:00<00:06, 82.60it/s] 14%|█▍        | 80/572 [00:00<00:05, 82.62it/s] 16%|█▌        | 89/572 [00:01<00:05, 82.96it/s] 17%|█▋        | 98/572 [00:01<00:05, 81.91it/s] 19%|█▊        | 107/572 [00:01<00:05, 81.76it/s] 20%|██        | 116/572 [00:01<00:05, 81.59it/s] 22%|██▏       | 125/572 [00:01<00:05, 80.78it/s] 23%|██▎       | 134/572 [00:01<00:05, 80.78it/s] 25%|██▌       | 143/572 [00:01<00:05, 81.18it/s] 27%|██▋       | 152/572 [00:01<00:05, 81.44it/s] 28%|██▊       | 161/572 [00:01<00:05, 81.91it/s] 30%|██▉       | 170/572 [00:02<00:04, 82.44it/s] 31%|███▏      | 179/572 [00:02<00:04, 81.56it/s] 33%|███▎      | 188/572 [00:02<00:04, 81.47it/s] 34%|███▍      | 197/572 [00:02<00:04, 78.19it/s] 36%|███▌      | 205/572 [00:02<00:04, 74.83it/s] 37%|███▋      | 214/572 [00:02<00:04, 76.95it/s] 39%|███▉      | 223/572 [00:02<00:04, 78.54it/s] 41%|████      | 232/572 [00:02<00:04, 79.45it/s] 42%|████▏     | 241/572 [00:02<00:04, 80.67it/s] 44%|████▎     | 250/572 [00:03<00:03, 81.75it/s] 45%|████▌     | 259/572 [00:03<00:03, 81.60it/s] 47%|████▋     | 268/572 [00:03<00:03, 80.17it/s] 48%|████▊     | 277/572 [00:03<00:03, 76.46it/s] 50%|████▉     | 285/572 [00:03<00:03, 75.81it/s] 51%|█████▏    | 294/572 [00:03<00:03, 77.83it/s] 53%|█████▎    | 303/572 [00:03<00:03, 78.23it/s] 55%|█████▍    | 312/572 [00:03<00:03, 79.16it/s] 56%|█████▌    | 321/572 [00:03<00:03, 80.23it/s] 58%|█████▊    | 330/572 [00:04<00:03, 80.00it/s] 59%|█████▉    | 339/572 [00:04<00:02, 79.86it/s] 61%|██████    | 347/572 [00:04<00:02, 78.99it/s] 62%|██████▏   | 355/572 [00:04<00:02, 77.38it/s] 63%|██████▎   | 363/572 [00:04<00:02, 75.40it/s] 65%|██████▍   | 371/572 [00:04<00:02, 73.42it/s] 66%|██████▋   | 379/572 [00:04<00:02, 71.90it/s] 68%|██████▊   | 387/572 [00:04<00:02, 73.40it/s] 69%|██████▉   | 396/572 [00:04<00:02, 75.86it/s] 71%|███████   | 405/572 [00:05<00:02, 77.74it/s] 72%|███████▏  | 414/572 [00:05<00:02, 78.50it/s] 74%|███████▍  | 423/572 [00:05<00:01, 79.53it/s] 76%|███████▌  | 432/572 [00:05<00:01, 80.50it/s] 77%|███████▋  | 441/572 [00:05<00:01, 79.91it/s] 79%|███████▊  | 450/572 [00:05<00:01, 77.07it/s] 80%|████████  | 458/572 [00:05<00:01, 75.34it/s] 81%|████████▏ | 466/572 [00:05<00:01, 76.07it/s] 83%|████████▎ | 475/572 [00:05<00:01, 77.99it/s] 85%|████████▍ | 484/572 [00:06<00:01, 78.88it/s] 86%|████████▌ | 492/572 [00:06<00:01, 76.43it/s] 87%|████████▋ | 500/572 [00:06<00:00, 72.78it/s] 89%|████████▉ | 508/572 [00:06<00:00, 72.71it/s] 90%|█████████ | 517/572 [00:06<00:00, 75.90it/s] 92%|█████████▏| 526/572 [00:06<00:00, 78.02it/s] 94%|█████████▎| 535/572 [00:06<00:00, 79.36it/s] 95%|█████████▌| 544/572 [00:06<00:00, 79.85it/s] 97%|█████████▋| 553/572 [00:06<00:00, 80.52it/s] 98%|█████████▊| 562/572 [00:07<00:00, 81.47it/s]100%|█████████▉| 571/572 [00:07<00:00, 79.49it/s]100%|██████████| 572/572 [00:07<00:00, 79.16it/s]
Train Epoch: 1 	 Loss: 0.4832551232
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  3.60it/s][[ 295  156]
 [ 266 3402]]
100%|██████████| 1/1 [00:00<00:00,  3.60it/s]

Test set: Average loss: 0.0001, Accuracy: 89.75%


Test set: Average fairness score:
Overall recall: 0.6541, 
Recall by Group: {0: 0.7441860465116279, 1: 0.6388888888888888, 2: 0.6580645161290323}, 
Equalized Odds: 0.7442, 
Demographic Parity: 0.0860 

{'accuracy': 89.75479485311969, 'avg_loss': 5.2887133297106395e-05, 'recall': 0.6541019955654102, 'avg_eq_odds': 0.7441860465116279, 'avg_dem_par': 0.08602065757312938, 'basic.4y': 0.7441860465116279, 'basic.6y': 0.6388888888888888, 'basic.9y': 0.6580645161290323}
wandb: WARNING Calling wandb.login() after wandb.init() has no effect.

=== RUN # 3 ====================================

  0%|          | 0/572 [00:00<?, ?it/s]  2%|▏         | 9/572 [00:00<00:06, 81.20it/s]  3%|▎         | 18/572 [00:00<00:06, 82.13it/s]  5%|▍         | 27/572 [00:00<00:06, 82.52it/s]  6%|▋         | 36/572 [00:00<00:06, 82.77it/s]  8%|▊         | 45/572 [00:00<00:06, 82.88it/s]  9%|▉         | 53/572 [00:00<00:06, 81.15it/s] 11%|█         | 61/572 [00:00<00:06, 79.88it/s] 12%|█▏        | 69/572 [00:00<00:06, 78.46it/s] 14%|█▎        | 78/572 [00:00<00:06, 79.15it/s] 15%|█▌        | 87/572 [00:01<00:06, 79.83it/s] 17%|█▋        | 95/572 [00:01<00:06, 78.65it/s] 18%|█▊        | 103/572 [00:01<00:05, 78.54it/s] 19%|█▉        | 111/572 [00:01<00:05, 78.23it/s] 21%|██        | 120/572 [00:01<00:05, 79.44it/s] 23%|██▎       | 129/572 [00:01<00:05, 80.29it/s] 24%|██▍       | 137/572 [00:01<00:05, 79.91it/s] 25%|██▌       | 145/572 [00:01<00:05, 78.68it/s] 27%|██▋       | 154/572 [00:01<00:05, 79.87it/s] 28%|██▊       | 163/572 [00:02<00:05, 80.51it/s] 30%|███       | 172/572 [00:02<00:05, 79.84it/s] 32%|███▏      | 181/572 [00:02<00:04, 81.68it/s] 33%|███▎      | 190/572 [00:02<00:04, 81.65it/s] 35%|███▍      | 199/572 [00:02<00:04, 82.58it/s] 36%|███▋      | 208/572 [00:02<00:04, 83.40it/s] 38%|███▊      | 217/572 [00:02<00:04, 83.83it/s] 40%|███▉      | 226/572 [00:02<00:04, 83.90it/s] 41%|████      | 235/572 [00:02<00:04, 84.14it/s] 43%|████▎     | 244/572 [00:02<00:03, 84.36it/s] 44%|████▍     | 253/572 [00:03<00:03, 84.36it/s] 46%|████▌     | 262/572 [00:03<00:03, 84.37it/s] 47%|████▋     | 271/572 [00:03<00:03, 83.99it/s] 49%|████▉     | 280/572 [00:03<00:03, 82.94it/s] 51%|█████     | 289/572 [00:03<00:03, 82.56it/s] 52%|█████▏    | 298/572 [00:03<00:03, 83.37it/s] 54%|█████▎    | 307/572 [00:03<00:03, 83.72it/s] 55%|█████▌    | 316/572 [00:03<00:03, 83.79it/s] 57%|█████▋    | 325/572 [00:03<00:02, 83.15it/s] 58%|█████▊    | 334/572 [00:04<00:02, 83.37it/s] 60%|█████▉    | 343/572 [00:04<00:02, 83.52it/s] 60%|██████    | 344/572 [00:04<00:02, 81.84it/s]
Traceback (most recent call last):
  File "main.py", line 222, in <module>
    main()
  File "main.py", line 170, in main
    train(args, model, device, train_data, optimizer, epoch)
  File "/Users/eunbeejang/Desktop/thesis/privacy-fairness-tradeoffs/run_train.py", line 19, in train
    output = model(cats, conts).view(-1)
  File "/Users/eunbeejang/miniconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/Users/eunbeejang/Desktop/thesis/privacy-fairness-tradeoffs/model.py", line 52, in forward
    if self.use_bn: x = b(x)
  File "/Users/eunbeejang/miniconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/module.py", line 722, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/Users/eunbeejang/miniconda3/envs/py38/lib/python3.8/site-packages/torch/nn/modules/normalization.py", line 245, in forward
    return F.group_norm(
  File "/Users/eunbeejang/miniconda3/envs/py38/lib/python3.8/site-packages/torch/nn/functional.py", line 2065, in group_norm
    return torch.group_norm(input, num_groups, weight, bias, eps,
KeyboardInterrupt
