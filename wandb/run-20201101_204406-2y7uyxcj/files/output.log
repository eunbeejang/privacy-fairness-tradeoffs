/Users/eunbeejang/miniconda3/envs/py38/lib/python3.8/site-packages/opacus/privacy_engine.py:110: UserWarning: Secure RNG turned off. This is perfectly fine for experimentation as it allows for much faster training performance, but remember to turn it on and retrain one last time before production with ``secure_rng`` turned on.
  warnings.warn(
  0%|          | 0/572 [00:00<?, ?it/s]RegressionModel(
  (embs): ModuleList(
    (0): Embedding(13, 6)
    (1): Embedding(5, 2)
    (2): Embedding(9, 4)
    (3): Embedding(4, 2)
    (4): Embedding(4, 2)
    (5): Embedding(4, 2)
    (6): Embedding(3, 1)
    (7): Embedding(11, 5)
    (8): Embedding(6, 3)
    (9): Embedding(4, 2)
  )
  (lins): ModuleList(
    (0): Linear(in_features=39, out_features=1000, bias=True)
    (1): Linear(in_features=1000, out_features=500, bias=True)
    (2): Linear(in_features=500, out_features=250, bias=True)
  )
  (bns): ModuleList(
    (0): GroupNorm(1, 1000, eps=1e-05, affine=True)
    (1): GroupNorm(1, 500, eps=1e-05, affine=True)
    (2): GroupNorm(1, 250, eps=1e-05, affine=True)
  )
  (outp): Linear(in_features=250, out_features=1, bias=True)
  (emb_drop): Dropout(p=0.04, inplace=False)
  (drops): ModuleList(
    (0): Dropout(p=0.001, inplace=False)
    (1): Dropout(p=0.01, inplace=False)
    (2): Dropout(p=0.01, inplace=False)
  )
  (bn): GroupNorm(1, 10, eps=1e-05, affine=True)
  (activation): Sigmoid()
) 


=== RUN # 0 ====================================

  0%|          | 1/572 [00:00<05:48,  1.64it/s]  0%|          | 2/572 [00:01<05:20,  1.78it/s]  1%|          | 3/572 [00:01<04:56,  1.92it/s]  1%|          | 4/572 [00:01<04:39,  2.03it/s]  1%|          | 5/572 [00:02<04:27,  2.12it/s]  1%|          | 6/572 [00:02<04:21,  2.16it/s]  1%|          | 7/572 [00:03<04:12,  2.24it/s]  1%|▏         | 8/572 [00:03<04:09,  2.26it/s]  2%|▏         | 9/572 [00:04<04:06,  2.29it/s]  2%|▏         | 10/572 [00:04<04:03,  2.31it/s]  2%|▏         | 11/572 [00:04<04:04,  2.29it/s]  2%|▏         | 12/572 [00:05<04:17,  2.18it/s]  2%|▏         | 13/572 [00:05<04:15,  2.19it/s]  2%|▏         | 14/572 [00:06<04:09,  2.24it/s]  3%|▎         | 15/572 [00:06<04:06,  2.26it/s]  3%|▎         | 16/572 [00:07<04:05,  2.26it/s]  3%|▎         | 17/572 [00:07<04:00,  2.31it/s]  3%|▎         | 18/572 [00:08<03:58,  2.33it/s]  3%|▎         | 19/572 [00:08<03:55,  2.35it/s]  3%|▎         | 20/572 [00:08<03:52,  2.37it/s]  4%|▎         | 21/572 [00:09<03:49,  2.41it/s]  4%|▍         | 22/572 [00:09<03:46,  2.43it/s]  4%|▍         | 23/572 [00:10<03:44,  2.44it/s]  4%|▍         | 24/572 [00:10<03:43,  2.45it/s]  4%|▍         | 25/572 [00:10<03:41,  2.46it/s]  5%|▍         | 26/572 [00:11<03:40,  2.47it/s]  5%|▍         | 27/572 [00:11<03:41,  2.46it/s]  5%|▍         | 28/572 [00:12<03:43,  2.43it/s]  5%|▌         | 29/572 [00:12<03:44,  2.42it/s]  5%|▌         | 30/572 [00:12<03:44,  2.41it/s]  5%|▌         | 31/572 [00:13<03:48,  2.37it/s]  6%|▌         | 32/572 [00:13<03:47,  2.37it/s]  6%|▌         | 33/572 [00:14<03:48,  2.36it/s]  6%|▌         | 34/572 [00:14<03:50,  2.34it/s]  6%|▌         | 35/572 [00:15<03:46,  2.37it/s]  6%|▋         | 36/572 [00:15<03:53,  2.30it/s]  6%|▋         | 37/572 [00:15<03:52,  2.30it/s]  7%|▋         | 38/572 [00:16<03:50,  2.32it/s]  7%|▋         | 39/572 [00:16<03:48,  2.33it/s]  7%|▋         | 40/572 [00:17<03:50,  2.31it/s]  7%|▋         | 41/572 [00:17<03:50,  2.30it/s]  7%|▋         | 42/572 [00:18<03:48,  2.32it/s]  8%|▊         | 43/572 [00:18<03:45,  2.35it/s]  8%|▊         | 44/572 [00:18<03:45,  2.35it/s]  8%|▊         | 45/572 [00:19<03:45,  2.34it/s]  8%|▊         | 46/572 [00:19<03:43,  2.35it/s]  8%|▊         | 47/572 [00:20<03:42,  2.36it/s]  8%|▊         | 48/572 [00:20<03:45,  2.33it/s]  9%|▊         | 49/572 [00:21<03:44,  2.33it/s]  9%|▊         | 50/572 [00:21<03:43,  2.34it/s]  9%|▉         | 51/572 [00:21<03:38,  2.38it/s]  9%|▉         | 52/572 [00:22<03:39,  2.37it/s]  9%|▉         | 53/572 [00:22<03:41,  2.35it/s]  9%|▉         | 54/572 [00:23<03:41,  2.34it/s] 10%|▉         | 55/572 [00:23<03:46,  2.28it/s] 10%|▉         | 56/572 [00:24<03:48,  2.26it/s] 10%|▉         | 57/572 [00:24<03:46,  2.27it/s] 10%|█         | 58/572 [00:24<03:44,  2.29it/s] 10%|█         | 59/572 [00:25<03:42,  2.30it/s] 10%|█         | 60/572 [00:25<03:40,  2.32it/s] 11%|█         | 61/572 [00:26<03:37,  2.35it/s] 11%|█         | 62/572 [00:26<03:35,  2.36it/s] 11%|█         | 63/572 [00:27<03:35,  2.36it/s] 11%|█         | 64/572 [00:27<03:38,  2.33it/s] 11%|█▏        | 65/572 [00:27<03:36,  2.34it/s] 12%|█▏        | 66/572 [00:28<03:36,  2.34it/s] 12%|█▏        | 67/572 [00:28<03:37,  2.32it/s] 12%|█▏        | 68/572 [00:29<03:39,  2.30it/s] 12%|█▏        | 69/572 [00:29<03:36,  2.32it/s] 12%|█▏        | 70/572 [00:30<03:33,  2.36it/s] 12%|█▏        | 71/572 [00:30<03:30,  2.39it/s] 13%|█▎        | 72/572 [00:30<03:29,  2.38it/s] 13%|█▎        | 73/572 [00:31<03:27,  2.40it/s] 13%|█▎        | 74/572 [00:31<03:27,  2.40it/s] 13%|█▎        | 75/572 [00:32<03:27,  2.40it/s] 13%|█▎        | 76/572 [00:32<03:27,  2.39it/s] 13%|█▎        | 76/572 [00:32<03:34,  2.31it/s]
Traceback (most recent call last):
  File "main.py", line 227, in <module>
    main()
  File "main.py", line 175, in main
    train(args, model, device, train_data, optimizer, epoch, s)
  File "/Users/eunbeejang/Desktop/thesis/privacy-fairness-tradeoffs/run_train.py", line 30, in train
    optimizer.step()
  File "/Users/eunbeejang/miniconda3/envs/py38/lib/python3.8/site-packages/opacus/privacy_engine.py", line 190, in dp_step
    self.privacy_engine.step()
  File "/Users/eunbeejang/miniconda3/envs/py38/lib/python3.8/site-packages/opacus/privacy_engine.py", line 260, in step
    self.clipper.clip_and_accumulate()
  File "/Users/eunbeejang/miniconda3/envs/py38/lib/python3.8/site-packages/opacus/per_sample_gradient_clip.py", line 190, in clip_and_accumulate
    all_norms = calc_sample_norms(
  File "/Users/eunbeejang/miniconda3/envs/py38/lib/python3.8/site-packages/opacus/utils/tensor_utils.py", line 42, in calc_sample_norms
    norms = [param.view(len(param), -1).norm(2, dim=-1) for name, param in named_params]
  File "/Users/eunbeejang/miniconda3/envs/py38/lib/python3.8/site-packages/opacus/utils/tensor_utils.py", line 42, in <listcomp>
    norms = [param.view(len(param), -1).norm(2, dim=-1) for name, param in named_params]
  File "/Users/eunbeejang/miniconda3/envs/py38/lib/python3.8/site-packages/torch/tensor.py", line 329, in norm
    return torch.norm(self, p, dim, keepdim, dtype=dtype)
  File "/Users/eunbeejang/miniconda3/envs/py38/lib/python3.8/site-packages/torch/functional.py", line 1123, in norm
    return _VF.norm(input, p, _dim, keepdim=keepdim)
KeyboardInterrupt
