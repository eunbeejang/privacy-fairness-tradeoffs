  0%|          | 0/572 [00:00<?, ?it/s]RegressionModel(
  (embs): ModuleList(
    (0): Embedding(13, 6)
    (1): Embedding(5, 2)
    (2): Embedding(9, 4)
    (3): Embedding(4, 2)
    (4): Embedding(4, 2)
    (5): Embedding(4, 2)
    (6): Embedding(3, 1)
    (7): Embedding(11, 5)
    (8): Embedding(6, 3)
    (9): Embedding(4, 2)
  )
  (lins): ModuleList(
    (0): Linear(in_features=39, out_features=1000, bias=True)
    (1): Linear(in_features=1000, out_features=500, bias=True)
    (2): Linear(in_features=500, out_features=250, bias=True)
  )
  (bns): ModuleList(
    (0): GroupNorm(1, 1000, eps=1e-05, affine=True)
    (1): GroupNorm(1, 500, eps=1e-05, affine=True)
    (2): GroupNorm(1, 250, eps=1e-05, affine=True)
  )
  (outp): Linear(in_features=250, out_features=1, bias=True)
  (emb_drop): Dropout(p=0.04, inplace=False)
  (drops): ModuleList(
    (0): Dropout(p=0.001, inplace=False)
    (1): Dropout(p=0.01, inplace=False)
    (2): Dropout(p=0.01, inplace=False)
  )
  (bn): GroupNorm(1, 10, eps=1e-05, affine=True)
  (activation): Sigmoid()
) 


=== RUN # 0 ====================================

  1%|▏         | 8/572 [00:00<00:07, 72.50it/s]  3%|▎         | 16/572 [00:00<00:07, 74.13it/s]  4%|▍         | 23/572 [00:00<00:07, 71.95it/s]  5%|▌         | 31/572 [00:00<00:07, 73.19it/s]  7%|▋         | 39/572 [00:00<00:07, 73.57it/s]  8%|▊         | 47/572 [00:00<00:07, 74.26it/s] 10%|▉         | 56/572 [00:00<00:06, 76.06it/s] 11%|█         | 64/572 [00:00<00:07, 71.46it/s] 13%|█▎        | 72/572 [00:00<00:06, 72.05it/s] 14%|█▍        | 81/572 [00:01<00:06, 74.19it/s] 16%|█▌        | 89/572 [00:01<00:06, 71.02it/s] 17%|█▋        | 97/572 [00:01<00:07, 67.53it/s] 18%|█▊        | 104/572 [00:01<00:07, 62.65it/s] 19%|█▉        | 111/572 [00:01<00:09, 46.59it/s] 20%|██        | 117/572 [00:01<00:09, 49.72it/s] 22%|██▏       | 124/572 [00:01<00:08, 52.62it/s] 23%|██▎       | 131/572 [00:02<00:08, 54.90it/s] 24%|██▍       | 137/572 [00:02<00:07, 55.37it/s] 25%|██▌       | 143/572 [00:02<00:07, 55.47it/s] 26%|██▌       | 150/572 [00:02<00:07, 57.69it/s] 27%|██▋       | 157/572 [00:02<00:07, 58.73it/s] 29%|██▊       | 164/572 [00:02<00:06, 61.06it/s] 30%|██▉       | 171/572 [00:02<00:06, 62.41it/s] 31%|███       | 178/572 [00:02<00:07, 50.10it/s] 32%|███▏      | 185/572 [00:03<00:07, 53.24it/s] 34%|███▎      | 192/572 [00:03<00:06, 56.22it/s] 35%|███▍      | 199/572 [00:03<00:06, 58.05it/s] 36%|███▌      | 206/572 [00:03<00:06, 59.81it/s] 37%|███▋      | 213/572 [00:03<00:05, 61.25it/s] 38%|███▊      | 220/572 [00:03<00:05, 60.42it/s] 40%|███▉      | 227/572 [00:03<00:05, 61.97it/s] 41%|████      | 235/572 [00:03<00:05, 64.36it/s] 42%|████▏     | 243/572 [00:03<00:04, 66.52it/s] 44%|████▍     | 251/572 [00:04<00:04, 67.82it/s] 45%|████▌     | 258/572 [00:04<00:04, 68.29it/s] 47%|████▋     | 266/572 [00:04<00:04, 68.64it/s] 48%|████▊     | 273/572 [00:04<00:04, 64.75it/s] 49%|████▉     | 280/572 [00:04<00:04, 63.82it/s] 50%|█████     | 287/572 [00:04<00:04, 63.48it/s] 51%|█████▏    | 294/572 [00:04<00:04, 63.25it/s] 53%|█████▎    | 301/572 [00:04<00:04, 64.93it/s] 54%|█████▍    | 309/572 [00:04<00:03, 66.56it/s] 55%|█████▌    | 317/572 [00:05<00:03, 67.76it/s] 57%|█████▋    | 324/572 [00:05<00:03, 67.69it/s] 58%|█████▊    | 331/572 [00:05<00:03, 68.22it/s] 59%|█████▉    | 339/572 [00:05<00:03, 68.67it/s] 61%|██████    | 347/572 [00:05<00:03, 69.79it/s] 62%|██████▏   | 354/572 [00:05<00:03, 69.69it/s] 63%|██████▎   | 362/572 [00:05<00:02, 70.08it/s] 65%|██████▍   | 370/572 [00:05<00:03, 66.85it/s] 66%|██████▋   | 379/572 [00:05<00:02, 70.98it/s] 68%|██████▊   | 388/572 [00:06<00:02, 74.08it/s] 69%|██████▉   | 396/572 [00:06<00:02, 71.42it/s] 71%|███████   | 404/572 [00:06<00:02, 72.93it/s] 72%|███████▏  | 412/572 [00:06<00:02, 72.78it/s] 73%|███████▎  | 420/572 [00:06<00:02, 73.29it/s] 75%|███████▍  | 428/572 [00:06<00:01, 72.08it/s] 76%|███████▋  | 437/572 [00:06<00:01, 75.06it/s] 78%|███████▊  | 445/572 [00:06<00:01, 76.30it/s] 79%|███████▉  | 453/572 [00:06<00:01, 72.27it/s] 81%|████████  | 461/572 [00:07<00:01, 71.33it/s] 82%|████████▏ | 470/572 [00:07<00:01, 73.99it/s] 84%|████████▎ | 479/572 [00:07<00:01, 76.84it/s] 85%|████████▌ | 487/572 [00:07<00:01, 77.26it/s] 87%|████████▋ | 495/572 [00:07<00:01, 74.05it/s] 88%|████████▊ | 503/572 [00:07<00:00, 74.73it/s] 89%|████████▉ | 511/572 [00:07<00:00, 75.45it/s] 91%|█████████ | 519/572 [00:07<00:00, 74.48it/s] 92%|█████████▏| 527/572 [00:07<00:00, 74.34it/s] 94%|█████████▎| 536/572 [00:07<00:00, 76.75it/s] 95%|█████████▌| 545/572 [00:08<00:00, 79.40it/s] 97%|█████████▋| 554/572 [00:08<00:00, 81.29it/s] 98%|█████████▊| 563/572 [00:08<00:00, 75.49it/s]100%|█████████▉| 571/572 [00:08<00:00, 75.81it/s]100%|██████████| 572/572 [00:08<00:00, 67.68it/s]
Train Epoch: 1 	 Loss: 0.4808895375
  0%|          | 0/1 [00:00<?, ?it/s]/Users/eunbeejang/miniconda3/envs/py38/lib/python3.8/site-packages/sklearn/utils/validation.py:67: FutureWarning: Pass labels=[1, 0] as keyword args. From version 0.25 passing these as positional arguments will result in an error
  warnings.warn("Pass {} as keyword args. From version 0.25 "
[[ 310  141]
 [ 286 3382]]
100%|██████████| 1/1 [00:00<00:00,  3.78it/s]
Test set: Average loss: 0.0001, Accuracy: 89.63%


Test set: Average fairness score:
Overall recall: 0.6874, 
Recall by Group: {0: 0.6744186046511628, 1: 0.7261904761904762, 2: 0.632258064516129}, 
Equalized Odds: 0.7262, 
Demographic Parity: 0.1691 

{'accuracy': 89.63340616654529, 'avg_loss': 5.575666137620297e-05, 'recall': 0.6873614190687362, 'avg_eq_odds': 0.7261904761904762, 'avg_dem_par': 0.1691240242844753, 'basic.4y': 0.6744186046511628, 'basic.6y': 0.7261904761904762, 'basic.9y': 0.632258064516129}
100%|██████████| 1/1 [00:00<00:00,  3.77it/s]
wandb: WARNING Calling wandb.login() after wandb.init() has no effect.

=== RUN # 1 ====================================

  0%|          | 0/572 [00:00<?, ?it/s]  2%|▏         | 9/572 [00:00<00:06, 81.33it/s]  3%|▎         | 16/572 [00:00<00:07, 77.53it/s]  4%|▍         | 24/572 [00:00<00:07, 76.93it/s]  6%|▌         | 32/572 [00:00<00:07, 76.81it/s]  7%|▋         | 41/572 [00:00<00:06, 78.02it/s]  9%|▊         | 49/572 [00:00<00:06, 78.45it/s] 10%|█         | 58/572 [00:00<00:06, 78.61it/s] 12%|█▏        | 67/572 [00:00<00:06, 80.00it/s] 13%|█▎        | 76/572 [00:00<00:06, 80.49it/s] 15%|█▍        | 84/572 [00:01<00:06, 76.09it/s] 16%|█▌        | 92/572 [00:01<00:06, 77.19it/s] 18%|█▊        | 101/572 [00:01<00:05, 79.02it/s] 19%|█▉        | 110/572 [00:01<00:05, 79.99it/s] 21%|██        | 118/572 [00:01<00:05, 78.59it/s] 22%|██▏       | 126/572 [00:01<00:06, 73.24it/s] 23%|██▎       | 134/572 [00:01<00:05, 75.01it/s] 25%|██▍       | 142/572 [00:01<00:05, 76.18it/s] 26%|██▌       | 150/572 [00:01<00:05, 77.02it/s] 28%|██▊       | 158/572 [00:02<00:05, 77.45it/s] 29%|██▉       | 167/572 [00:02<00:05, 79.52it/s] 31%|███       | 175/572 [00:02<00:05, 77.24it/s] 32%|███▏      | 183/572 [00:02<00:05, 71.97it/s] 33%|███▎      | 191/572 [00:02<00:05, 70.74it/s] 35%|███▍      | 199/572 [00:02<00:05, 67.68it/s] 36%|███▌      | 207/572 [00:02<00:05, 69.01it/s] 38%|███▊      | 216/572 [00:02<00:04, 72.16it/s] 39%|███▉      | 224/572 [00:02<00:04, 73.55it/s] 41%|████      | 232/572 [00:03<00:04, 74.74it/s] 42%|████▏     | 240/572 [00:03<00:04, 76.14it/s] 43%|████▎     | 248/572 [00:03<00:04, 77.02it/s] 45%|████▍     | 257/572 [00:03<00:03, 79.00it/s] 46%|████▋     | 265/572 [00:03<00:03, 77.45it/s] 48%|████▊     | 274/572 [00:03<00:03, 78.92it/s] 49%|████▉     | 283/572 [00:03<00:03, 80.66it/s] 51%|█████     | 292/572 [00:03<00:03, 82.23it/s] 53%|█████▎    | 301/572 [00:03<00:03, 83.28it/s] 54%|█████▍    | 310/572 [00:04<00:03, 78.88it/s] 56%|█████▌    | 318/572 [00:04<00:03, 71.53it/s] 57%|█████▋    | 326/572 [00:04<00:03, 68.79it/s] 58%|█████▊    | 334/572 [00:04<00:03, 70.47it/s] 60%|█████▉    | 342/572 [00:04<00:03, 70.79it/s] 61%|██████    | 350/572 [00:04<00:03, 71.79it/s] 63%|██████▎   | 358/572 [00:04<00:02, 73.24it/s] 64%|██████▍   | 366/572 [00:04<00:02, 74.63it/s] 65%|██████▌   | 374/572 [00:04<00:02, 75.76it/s] 67%|██████▋   | 382/572 [00:05<00:02, 76.03it/s] 68%|██████▊   | 390/572 [00:05<00:02, 73.95it/s] 70%|██████▉   | 398/572 [00:05<00:02, 73.93it/s] 71%|███████   | 407/572 [00:05<00:02, 75.86it/s] 73%|███████▎  | 415/572 [00:05<00:02, 74.56it/s] 74%|███████▍  | 423/572 [00:05<00:02, 72.27it/s] 75%|███████▌  | 431/572 [00:05<00:02, 70.40it/s] 77%|███████▋  | 439/572 [00:05<00:01, 72.36it/s] 78%|███████▊  | 447/572 [00:05<00:01, 72.13it/s] 80%|███████▉  | 455/572 [00:06<00:01, 71.08it/s] 81%|████████  | 463/572 [00:06<00:01, 67.19it/s] 82%|████████▏ | 471/572 [00:06<00:01, 69.63it/s] 84%|████████▎ | 479/572 [00:06<00:01, 70.95it/s] 85%|████████▌ | 487/572 [00:06<00:01, 71.91it/s] 87%|████████▋ | 496/572 [00:06<00:01, 75.59it/s] 88%|████████▊ | 504/572 [00:06<00:00, 76.76it/s] 90%|████████▉ | 512/572 [00:06<00:00, 77.62it/s] 91%|█████████ | 520/572 [00:06<00:00, 77.89it/s] 92%|█████████▏| 528/572 [00:07<00:00, 78.36it/s] 94%|█████████▍| 537/572 [00:07<00:00, 79.37it/s] 95%|█████████▌| 546/572 [00:07<00:00, 80.31it/s] 97%|█████████▋| 555/572 [00:07<00:00, 81.58it/s] 99%|█████████▊| 564/572 [00:07<00:00, 82.47it/s]100%|██████████| 572/572 [00:07<00:00, 75.97it/s]Train Epoch: 1 	 Loss: 0.4511255821

  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  2.67it/s][[ 316  135]
 [ 316 3352]]100%|██████████| 1/1 [00:00<00:00,  2.67it/s]
wandb: WARNING Calling wandb.login() after wandb.init() has no effect.


Test set: Average loss: 0.0001, Accuracy: 89.05%


Test set: Average fairness score:
Overall recall: 0.7007, 
Recall by Group: {0: 0.6511627906976745, 1: 0.7063492063492064, 2: 0.7032258064516129, 3: 1.0}, 
Equalized Odds: 0.3488, 
Demographic Parity: 0.2583 

{'accuracy': 89.0507404709881, 'avg_loss': 5.736754238099026e-05, 'recall': 0.7006651884700665, 'avg_eq_odds': 0.34883720930232553, 'avg_dem_par': 0.25825519771708116, 'basic.4y': 0.6511627906976745, 'basic.6y': 0.7063492063492064, 'basic.9y': 0.7032258064516129, 'high.school': 1.0}

=== RUN # 2 ====================================
  0%|          | 0/572 [00:00<?, ?it/s]
  1%|          | 6/572 [00:00<00:10, 54.78it/s]  2%|▏         | 14/572 [00:00<00:09, 58.92it/s]  4%|▍         | 23/572 [00:00<00:08, 64.59it/s]  6%|▌         | 32/572 [00:00<00:07, 69.96it/s]  7%|▋         | 41/572 [00:00<00:07, 73.55it/s]  8%|▊         | 48/572 [00:00<00:07, 69.99it/s] 10%|▉         | 55/572 [00:00<00:07, 68.78it/s] 11%|█         | 63/572 [00:00<00:07, 71.13it/s] 13%|█▎        | 72/572 [00:00<00:06, 75.10it/s] 14%|█▍        | 80/572 [00:01<00:06, 75.53it/s] 15%|█▌        | 88/572 [00:01<00:06, 74.70it/s] 17%|█▋        | 96/572 [00:01<00:06, 73.03it/s] 18%|█▊        | 104/572 [00:01<00:06, 73.17it/s] 20%|█▉        | 112/572 [00:01<00:06, 73.84it/s] 21%|██        | 120/572 [00:01<00:06, 73.55it/s] 23%|██▎       | 129/572 [00:01<00:05, 76.09it/s] 24%|██▍       | 137/572 [00:01<00:05, 73.94it/s] 25%|██▌       | 145/572 [00:01<00:05, 73.31it/s] 27%|██▋       | 153/572 [00:02<00:05, 74.26it/s] 28%|██▊       | 161/572 [00:02<00:05, 73.68it/s] 30%|██▉       | 169/572 [00:02<00:05, 72.81it/s] 31%|███       | 177/572 [00:02<00:05, 74.42it/s] 32%|███▏      | 185/572 [00:02<00:05, 74.05it/s] 34%|███▎      | 193/572 [00:02<00:05, 72.68it/s] 35%|███▌      | 201/572 [00:02<00:05, 73.13it/s] 37%|███▋      | 209/572 [00:02<00:04, 73.62it/s] 38%|███▊      | 217/572 [00:02<00:04, 72.14it/s] 39%|███▉      | 225/572 [00:03<00:04, 72.57it/s] 41%|████      | 233/572 [00:03<00:04, 70.43it/s] 42%|████▏     | 241/572 [00:03<00:04, 71.19it/s] 44%|████▎     | 249/572 [00:03<00:04, 72.01it/s] 45%|████▍     | 257/572 [00:03<00:04, 65.71it/s] 46%|████▌     | 264/572 [00:03<00:04, 64.09it/s] 48%|████▊     | 272/572 [00:03<00:05, 55.06it/s] 49%|████▊     | 278/572 [00:03<00:05, 55.08it/s] 50%|████▉     | 285/572 [00:04<00:04, 57.92it/s] 51%|█████     | 293/572 [00:04<00:04, 61.05it/s] 52%|█████▏    | 300/572 [00:04<00:04, 62.13it/s] 54%|█████▍    | 308/572 [00:04<00:04, 65.26it/s] 55%|█████▌    | 315/572 [00:04<00:03, 66.21it/s] 56%|█████▋    | 322/572 [00:04<00:04, 62.43it/s] 58%|█████▊    | 329/572 [00:04<00:03, 62.01it/s] 59%|█████▊    | 336/572 [00:04<00:03, 63.65it/s] 60%|██████    | 344/572 [00:04<00:03, 65.39it/s] 61%|██████▏   | 351/572 [00:05<00:03, 63.18it/s] 63%|██████▎   | 358/572 [00:05<00:03, 64.06it/s] 64%|██████▍   | 366/572 [00:05<00:03, 67.15it/s] 65%|██████▌   | 373/572 [00:05<00:02, 67.95it/s] 67%|██████▋   | 381/572 [00:05<00:02, 69.24it/s] 68%|██████▊   | 389/572 [00:05<00:02, 71.96it/s] 70%|██████▉   | 398/572 [00:05<00:02, 75.56it/s] 71%|███████   | 407/572 [00:05<00:02, 77.78it/s] 73%|███████▎  | 416/572 [00:05<00:01, 79.73it/s] 74%|███████▍  | 425/572 [00:06<00:01, 80.92it/s] 76%|███████▌  | 434/572 [00:06<00:01, 81.39it/s] 77%|███████▋  | 443/572 [00:06<00:01, 82.38it/s] 79%|███████▉  | 452/572 [00:06<00:01, 81.10it/s] 81%|████████  | 461/572 [00:06<00:01, 81.34it/s] 82%|████████▏ | 470/572 [00:06<00:01, 81.32it/s] 84%|████████▎ | 479/572 [00:06<00:01, 82.03it/s] 85%|████████▌ | 488/572 [00:06<00:01, 82.71it/s] 87%|████████▋ | 497/572 [00:06<00:00, 82.58it/s] 88%|████████▊ | 506/572 [00:07<00:00, 76.29it/s] 90%|████████▉ | 514/572 [00:07<00:00, 73.88it/s] 91%|█████████▏| 522/572 [00:07<00:00, 73.28it/s] 93%|█████████▎| 530/572 [00:07<00:00, 71.72it/s] 94%|█████████▍| 538/572 [00:07<00:00, 71.19it/s] 95%|█████████▌| 546/572 [00:07<00:00, 72.15it/s] 97%|█████████▋| 555/572 [00:07<00:00, 75.33it/s] 99%|█████████▊| 564/572 [00:07<00:00, 77.18it/s]100%|██████████| 572/572 [00:07<00:00, 76.00it/s]Train Epoch: 1 	 Loss: 0.4864541795100%|██████████| 572/572 [00:07<00:00, 72.17it/s]

  0%|          | 0/1 [00:00<?, ?it/s][[ 329  122]
 [ 335 3333]]100%|██████████| 1/1 [00:00<00:00,  3.20it/s]
100%|██████████| 1/1 [00:00<00:00,  3.20it/s]

Test set: Average loss: 0.0001, Accuracy: 88.91%


Test set: Average fairness score:
Overall recall: 0.7295, 
Recall by Group: {0: 0.813953488372093, 1: 0.7341269841269841, 2: 0.7032258064516129}, 
Equalized Odds: 0.8140, 
Demographic Parity: 0.0629 

{'accuracy': 88.90507404709881, 'avg_loss': 5.806185545693268e-05, 'recall': 0.729490022172949, 'avg_eq_odds': 0.813953488372093, 'avg_dem_par': 0.06286440799245871, 'basic.4y': 0.813953488372093, 'basic.6y': 0.7341269841269841, 'basic.9y': 0.7032258064516129}
