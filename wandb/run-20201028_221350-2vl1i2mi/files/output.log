RegressionModel(
  (embs): ModuleList(
    (0): Embedding(13, 6)
    (1): Embedding(5, 2)
    (2): Embedding(9, 4)
    (3): Embedding(4, 2)
    (4): Embedding(4, 2)
    (5): Embedding(4, 2)
    (6): Embedding(3, 1)
    (7): Embedding(11, 5)
    (8): Embedding(6, 3)
    (9): Embedding(4, 2)
  )
  (lins): ModuleList(
    (0): Linear(in_features=39, out_features=1000, bias=True)
    (1): Linear(in_features=1000, out_features=500, bias=True)
    (2): Linear(in_features=500, out_features=250, bias=True)
  )
  (bns): ModuleList(
    (0): GroupNorm(1, 1000, eps=1e-05, affine=True)
    (1): GroupNorm(1, 500, eps=1e-05, affine=True)
    (2): GroupNorm(1, 250, eps=1e-05, affine=True)
  )
  (outp): Linear(in_features=250, out_features=1, bias=True)
  (emb_drop): Dropout(p=0.04, inplace=False)
  (drops): ModuleList(
    (0): Dropout(p=0.001, inplace=False)
    (1): Dropout(p=0.01, inplace=False)
    (2): Dropout(p=0.01, inplace=False)
  )
  (bn): GroupNorm(1, 10, eps=1e-05, affine=True)
  (activation): Sigmoid()
)  0%|          | 0/572 [00:00<?, ?it/s] 


=== RUN # 0 ====================================

  1%|▏         | 8/572 [00:00<00:07, 71.10it/s]  3%|▎         | 16/572 [00:00<00:07, 73.15it/s]  4%|▍         | 25/572 [00:00<00:07, 76.47it/s]  6%|▌         | 34/572 [00:00<00:06, 79.14it/s]  7%|▋         | 42/572 [00:00<00:06, 77.81it/s]  9%|▊         | 50/572 [00:00<00:06, 77.69it/s] 10%|█         | 58/572 [00:00<00:06, 76.88it/s] 12%|█▏        | 66/572 [00:00<00:06, 76.93it/s] 13%|█▎        | 75/572 [00:00<00:06, 79.42it/s] 15%|█▍        | 83/572 [00:01<00:06, 76.91it/s] 16%|█▌        | 92/572 [00:01<00:06, 79.20it/s] 18%|█▊        | 101/572 [00:01<00:05, 80.60it/s] 19%|█▉        | 110/572 [00:01<00:05, 81.72it/s] 21%|██        | 119/572 [00:01<00:05, 82.59it/s] 22%|██▏       | 128/572 [00:01<00:05, 76.61it/s] 24%|██▍       | 137/572 [00:01<00:05, 79.01it/s] 26%|██▌       | 146/572 [00:01<00:05, 80.86it/s] 27%|██▋       | 155/572 [00:01<00:05, 81.67it/s] 29%|██▊       | 164/572 [00:02<00:04, 82.03it/s] 30%|███       | 173/572 [00:02<00:04, 81.52it/s] 32%|███▏      | 182/572 [00:02<00:04, 81.55it/s] 33%|███▎      | 191/572 [00:02<00:04, 82.54it/s] 35%|███▍      | 200/572 [00:02<00:04, 82.48it/s] 37%|███▋      | 209/572 [00:02<00:04, 82.61it/s] 38%|███▊      | 218/572 [00:02<00:04, 83.38it/s] 40%|███▉      | 227/572 [00:02<00:04, 83.54it/s] 41%|████▏     | 236/572 [00:02<00:04, 83.91it/s] 43%|████▎     | 245/572 [00:03<00:03, 84.38it/s] 44%|████▍     | 254/572 [00:03<00:03, 84.15it/s] 46%|████▌     | 263/572 [00:03<00:03, 83.98it/s] 48%|████▊     | 272/572 [00:03<00:03, 83.92it/s] 49%|████▉     | 281/572 [00:03<00:03, 84.43it/s] 51%|█████     | 290/572 [00:03<00:03, 84.65it/s] 52%|█████▏    | 299/572 [00:03<00:03, 84.99it/s] 54%|█████▍    | 308/572 [00:03<00:03, 85.05it/s] 55%|█████▌    | 317/572 [00:03<00:03, 84.98it/s] 57%|█████▋    | 326/572 [00:03<00:02, 84.94it/s] 59%|█████▊    | 335/572 [00:04<00:02, 84.92it/s] 60%|██████    | 344/572 [00:04<00:02, 84.82it/s] 62%|██████▏   | 353/572 [00:04<00:02, 84.77it/s] 63%|██████▎   | 362/572 [00:04<00:02, 84.52it/s] 65%|██████▍   | 371/572 [00:04<00:02, 84.14it/s] 66%|██████▋   | 380/572 [00:04<00:02, 84.57it/s] 68%|██████▊   | 389/572 [00:04<00:02, 83.74it/s] 70%|██████▉   | 398/572 [00:04<00:02, 83.81it/s] 71%|███████   | 407/572 [00:04<00:01, 83.43it/s] 73%|███████▎  | 416/572 [00:05<00:01, 83.59it/s] 74%|███████▍  | 425/572 [00:05<00:01, 83.36it/s] 76%|███████▌  | 434/572 [00:05<00:01, 83.70it/s] 77%|███████▋  | 443/572 [00:05<00:01, 84.22it/s] 79%|███████▉  | 452/572 [00:05<00:01, 84.13it/s] 81%|████████  | 461/572 [00:05<00:01, 84.40it/s] 82%|████████▏ | 470/572 [00:05<00:01, 84.74it/s] 84%|████████▎ | 479/572 [00:05<00:01, 85.11it/s] 85%|████████▌ | 488/572 [00:05<00:00, 85.09it/s] 87%|████████▋ | 497/572 [00:06<00:00, 84.91it/s] 88%|████████▊ | 506/572 [00:06<00:00, 84.32it/s] 90%|█████████ | 515/572 [00:06<00:00, 83.91it/s] 92%|█████████▏| 524/572 [00:06<00:00, 84.34it/s] 93%|█████████▎| 533/572 [00:06<00:00, 84.81it/s] 95%|█████████▍| 542/572 [00:06<00:00, 84.99it/s] 96%|█████████▋| 551/572 [00:06<00:00, 85.11it/s] 98%|█████████▊| 560/572 [00:06<00:00, 84.12it/s] 99%|█████████▉| 569/572 [00:06<00:00, 83.86it/s]100%|██████████| 572/572 [00:06<00:00, 83.01it/s]
Train Epoch: 1 	 Loss: 0.4813411200
  0%|          | 0/1 [00:00<?, ?it/s]/Users/eunbeejang/miniconda3/envs/py38/lib/python3.8/site-packages/sklearn/utils/validation.py:67: FutureWarning: Pass labels=[1, 0] as keyword args. From version 0.25 passing these as positional arguments will result in an error
  warnings.warn("Pass {} as keyword args. From version 0.25 "
[[ 311  140]
 [ 309 3359]]100%|██████████| 1/1 [00:00<00:00,  3.89it/s]

Test set: Average loss: 0.0001, Accuracy: 89.10%


Test set: Average fairness score:
Overall recall: 0.6896, 
Recall by Group: {0: 0.7674418604651163, 1: 0.7261904761904762, 2: 0.6129032258064516}, 
Equalized Odds: 0.7674, 
Demographic Parity: 0.0450 

100%|██████████| 1/1 [00:00<00:00,  3.88it/s]
Traceback (most recent call last):
  File "main.py", line 220, in <module>
    main()
  File "main.py", line 193, in main
    category = sensitive_cat_keys[i.key()]
AttributeError: 'numpy.int64' object has no attribute 'key'
